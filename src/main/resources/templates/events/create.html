<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="partials/navbar :: head('Create an Event')"></head>

<body>

<div class="register-bg">
    <nav th:replace="partials/navbar :: navbar" />
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12">
                <form class ="center" th:action="@{/events/create}" th:method="POST" th:object="${event}">
                    <fieldset class="registration-Transparency container-fluid">
                        <div id="legend">
                            <legend style="font-size: 2.5em">Create Your Event</legend>
                        </div>

                        <div class="control-group">
                            <!-- Name -->
                            <label class="control-label" for="name">Name</label>
                            <div class="controls">
                                <input type="text" id="name" name="name" class="input-xlarge" th:field="*{name}"/>
                            </div>
                        </div>

                        <div class="control-group">
                            <!-- Start Date -->
                            <label class="control-label"  for="start_date">Start Date</label>
                            <div class="controls">
                                <input type="date"  placeholder="" class="input-xlarge" th:field="*{start_date}"/>
                            </div>
                        </div>

                        <div class="control-group">
                            <!-- End Date -->
                            <label class="control-label" for="end_date">End Date</label>
                            <div class="controls">
                                <input type="date" placeholder="" class="input-xlarge" th:field="*{end_date}"/>
                            </div>
                        </div>

                        <div class="control-group">
                            <!-- Location-->
                            <label class="control-label" for="location">Location</label>
                            <div class="controls">
                                <input id="location" name="location" placeholder="" class="input-xlarge" th:field="*{location}"/>
                            </div>
                        </div>

                        <div class="control-group">
                            <!-- URL -->
                            <label class="control-label" for="url">Create your own URL</label>
                            <div class="controls">
                                <input type="text" id="url" name="url" placeholder="" class="input-xlarge" th:field="*{url}"/>
                            </div>
                        </div>

                        <!--upload form-->
                            <div id="upload_legend">
                                <legend style="font-size: 2.5em">Upload a file </legend>
                            </div>

                            <div class="control-group">
                                <div class="controls">
                                    <button onclick="openPicker()" type="button" class="btn btn-link btn-secondary" >
                                        Upload Image</button>
                                </div>
                            </div>

                            <div id="picUrl"></div>

                            <div id="posts" class="container-fluid"></div>


                            <div class="control-group">
                            <!-- Button -->
                                <div class="controls">
                                    <button class="btn btn-primary">Create</button>
                                </div>
                            </div>
                        </fieldset>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://static.filestackapi.com/v3/filestack.js"></script>
<div th:replace="partials/navbar :: scripts" />

<script th:inline="javascript">
    // FILESTACK JSON CALL
    var fsClient = filestack.init('An8EGKOh9TGGuI8Vymqonz');
    function openPicker() {
        fsClient.pick({
            fromSources:["local_file_system", "url","imagesearch","facebook","instagram","dropbox"],
            accept:["image/*"],
            maxFiles:1
        }).then(function(response) {
            // declare this function to handle response
            handleFilestack(response);
        });
    }

    function handleFilestack(response){
    $('#picUrl').append('<input type="text" id="upload" name="upload" value=" ' +response.filesUploaded['0'].url +  '" />');
    $('#posts').append('<div class="container">');
    $('#posts').append('<img src=" ' + response.filesUploaded['0'].url + ' " style="\width: 40%\" />');
    $('#posts').append('</div>');

    document.getElementById('upload').dataset.handler = response.url;
}

</script>

</body>
</html>